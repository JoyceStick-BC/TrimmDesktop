<!DOCTYPE html>
<html>
   <head>
      <meta charset = "UTF-8">
      <title>Home</title>
   </head>

   <body>
      <h1>Trimm Desktop</h1>
      <p>Select project directory:</p>
      <p id="current"><b>No Current Directory Selected</b></p>
      <form action="index.html" id="form">
          <button type="button" id="choose-file">Select File</button>
          <p id="file-input" style="display:none"></p>
      </form>
      <div id="options" style="display:none">
          <p>Download All Project Assets:</p>
          <button type="button" name="button" id="trimm_install">Trimm Pull</button>
          <p>Download New Asset:</p>
          <input type="text" name="" value="" placeholder="username/bundlename">
          <button type="button" name="button">Trimm Install</button>
      </div>
   </body>
   <script type="text/javascript">
       var textEncoding = require('text-encoding');
       var TextDecoder = textEncoding.TextDecoder;
       let $ = require('jquery')
       $('#trimm_install').on('click', function() {
           if ($('#file-input').text() == "") {
               $('#current').html("<b>Please select a file!</b>");
               return;
           }
           var spawn = require('child_process').spawn;
           var py = spawn('python', ['./Trimm-CLI-master/trimm.py', 'pull', $('#file-input').text()])
           py.stdout.on('data', function(data){
               var response = new TextDecoder("utf-8").decode(data);
               console.log(response);
           });
           py.stderr.on('data', function(data) {
                console.error(data.toString());
            });
       });

       $('#choose-file').on('click', function() {
           const {dialog} = require('electron').remote;
           var filepath = dialog.showOpenDialog({properties: ['openFile', 'openDirectory', 'multiSelections']});
           $('#file-input').text(filepath[0] + "/");
           $('#current').html("<b>Currrent Directory: " + filepath[0] + "/</b>");
           $('#options').css('display', 'block');
       })
       </script>
</html>
